<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>使用统计</title>
  <link rel="stylesheet" href="../../css/bootstrap.min.css">
  <link rel="stylesheet" href="../../css/bootstrap-icons.css">
  <link rel="stylesheet" href="../../css/styles.css">
</head>
<body>
  <div id="usage-statistics-module" class="container-fluid py-3">
    <div class="row mb-4">
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
          <h4 class="mb-0">使用统计</h4>
          <div>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-outline-secondary active">日</button>
              <button type="button" class="btn btn-outline-secondary">周</button>
              <button type="button" class="btn btn-outline-secondary">月</button>
              <button type="button" class="btn btn-outline-secondary">季</button>
            </div>
            <button class="btn btn-outline-primary ms-2">
              <i class="bi bi-download me-1"></i>导出数据
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 使用概览卡片 -->
    <div class="row mb-4">
      <div class="col-md-3">
        <div class="card h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <div>
                <h6 class="text-muted">活跃用户数</h6>
                <h3 class="mb-0">243</h3>
              </div>
              <div class="rounded-circle bg-primary-soft p-3">
                <i class="bi bi-people"></i>
              </div>
            </div>
            <div class="d-flex align-items-center mt-3">
              <span class="badge bg-success me-1">
                <i class="bi bi-arrow-up-short"></i> 8.4%
              </span>
              <span class="small text-muted">较昨日</span>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <div>
                <h6 class="text-muted">浏览量</h6>
                <h3 class="mb-0">1,874</h3>
              </div>
              <div class="rounded-circle bg-success-soft p-3">
                <i class="bi bi-eye"></i>
              </div>
            </div>
            <div class="d-flex align-items-center mt-3">
              <span class="badge bg-success me-1">
                <i class="bi bi-arrow-up-short"></i> 12.3%
              </span>
              <span class="small text-muted">较昨日</span>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <div>
                <h6 class="text-muted">平均停留时间</h6>
                <h3 class="mb-0">6分42秒</h3>
              </div>
              <div class="rounded-circle bg-info-soft p-3">
                <i class="bi bi-clock"></i>
              </div>
            </div>
            <div class="d-flex align-items-center mt-3">
              <span class="badge bg-success me-1">
                <i class="bi bi-arrow-up-short"></i> 5.7%
              </span>
              <span class="small text-muted">较昨日</span>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card h-100">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <div>
                <h6 class="text-muted">人均访问文档</h6>
                <h3 class="mb-0">7.8篇</h3>
              </div>
              <div class="rounded-circle bg-warning-soft p-3">
                <i class="bi bi-file-earmark-text"></i>
              </div>
            </div>
            <div class="d-flex align-items-center mt-3">
              <span class="badge bg-danger me-1">
                <i class="bi bi-arrow-down-short"></i> 2.1%
              </span>
              <span class="small text-muted">较昨日</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 用户活跃度与文档访问量 -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="card-title mb-0">用户活跃度与文档访问量</h5>
              <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="usageChartOptions" data-bs-toggle="dropdown" aria-expanded="false">
                  显示选项
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="usageChartOptions">
                  <li><a class="dropdown-item active" href="#">全部显示</a></li>
                  <li><a class="dropdown-item" href="#">仅用户活跃度</a></li>
                  <li><a class="dropdown-item" href="#">仅文档访问量</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="usageActivityChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 使用时段分布和部门使用对比 -->
    <div class="row mb-4">
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">使用时段分布</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="timeDistributionChart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card h-100">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">部门使用对比</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="departmentUsageChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 用户行为分析 -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-white">
            <h5 class="card-title mb-0">用户行为分析</h5>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-8">
                <div class="chart-container" style="height: 300px;">
                  <canvas id="userBehaviorChart"></canvas>
                </div>
              </div>
              <div class="col-md-4">
                <div class="h-100 d-flex flex-column justify-content-between">
                  <div class="behavior-metric">
                    <h6 class="text-muted mb-2">阅读文档</h6>
                    <div class="d-flex align-items-center">
                      <div class="progress flex-grow-1 me-3" style="height: 8px;">
                        <div class="progress-bar bg-primary" role="progressbar" style="width: 75%;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="fw-bold">75%</span>
                    </div>
                  </div>
                  <div class="behavior-metric">
                    <h6 class="text-muted mb-2">搜索内容</h6>
                    <div class="d-flex align-items-center">
                      <div class="progress flex-grow-1 me-3" style="height: 8px;">
                        <div class="progress-bar bg-success" role="progressbar" style="width: 62%;" aria-valuenow="62" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="fw-bold">62%</span>
                    </div>
                  </div>
                  <div class="behavior-metric">
                    <h6 class="text-muted mb-2">上传文档</h6>
                    <div class="d-flex align-items-center">
                      <div class="progress flex-grow-1 me-3" style="height: 8px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 28%;" aria-valuenow="28" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="fw-bold">28%</span>
                    </div>
                  </div>
                  <div class="behavior-metric">
                    <h6 class="text-muted mb-2">评论互动</h6>
                    <div class="d-flex align-items-center">
                      <div class="progress flex-grow-1 me-3" style="height: 8px;">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: 18%;" aria-valuenow="18" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="fw-bold">18%</span>
                    </div>
                  </div>
                  <div class="behavior-metric">
                    <h6 class="text-muted mb-2">使用智能助手</h6>
                    <div class="d-flex align-items-center">
                      <div class="progress flex-grow-1 me-3" style="height: 8px;">
                        <div class="progress-bar bg-danger" role="progressbar" style="width: 42%;" aria-valuenow="42" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                      <span class="fw-bold">42%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 最活跃用户 -->
    <div class="row">
      <div class="col-12">
        <div class="card">
          <div class="card-header bg-white">
            <div class="d-flex justify-content-between align-items-center">
              <h5 class="card-title mb-0">最活跃用户TOP 10</h5>
              <div class="dropdown">
                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="activeUserOptions" data-bs-toggle="dropdown" aria-expanded="false">
                  <i class="bi bi-sort-down me-1"></i>排序依据
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="activeUserOptions">
                  <li><a class="dropdown-item active" href="#">按访问量</a></li>
                  <li><a class="dropdown-item" href="#">按上传量</a></li>
                  <li><a class="dropdown-item" href="#">按互动量</a></li>
                  <li><a class="dropdown-item" href="#">按停留时间</a></li>
                </ul>
              </div>
            </div>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-hover align-middle mb-0">
                <thead class="bg-light">
                  <tr>
                    <th>用户</th>
                    <th>部门</th>
                    <th>访问次数</th>
                    <th>上传文档</th>
                    <th>互动次数</th>
                    <th>平均停留</th>
                    <th>活跃趋势</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-circle bg-primary text-white me-2">ZW</div>
                        <span>张伟</span>
                      </div>
                    </td>
                    <td>研发部</td>
                    <td>187</td>
                    <td>15</td>
                    <td>42</td>
                    <td>8分12秒</td>
                    <td>
                      <span class="badge bg-success">上升</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-circle bg-success text-white me-2">LM</div>
                        <span>李明</span>
                      </div>
                    </td>
                    <td>产品部</td>
                    <td>163</td>
                    <td>23</td>
                    <td>35</td>
                    <td>7分45秒</td>
                    <td>
                      <span class="badge bg-success">上升</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-circle bg-info text-white me-2">WF</div>
                        <span>王芳</span>
                      </div>
                    </td>
                    <td>设计部</td>
                    <td>156</td>
                    <td>12</td>
                    <td>28</td>
                    <td>6分58秒</td>
                    <td>
                      <span class="badge bg-success">上升</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-circle bg-warning text-white me-2">ZM</div>
                        <span>赵敏</span>
                      </div>
                    </td>
                    <td>市场部</td>
                    <td>142</td>
                    <td>8</td>
                    <td>32</td>
                    <td>5分36秒</td>
                    <td>
                      <span class="badge bg-secondary">持平</span>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex align-items-center">
                        <div class="avatar-circle bg-danger text-white me-2">CL</div>
                        <span>陈力</span>
                      </div>
                    </td>
                    <td>研发部</td>
                    <td>138</td>
                    <td>17</td>
                    <td>25</td>
                    <td>7分22秒</td>
                    <td>
                      <span class="badge bg-danger">下降</span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 引入脚本 -->
  <script src="../../js/bootstrap.bundle.min.js"></script>
  <script src="../../js/chart.js"></script>
  <script>
    // 页面加载完成后初始化图表
    document.addEventListener('DOMContentLoaded', function() {
      // 用户活跃度与文档访问量图表
      const usageCtx = document.getElementById('usageActivityChart').getContext('2d');
      const usageChart = new Chart(usageCtx, {
        type: 'line',
        data: {
          labels: ['9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00'],
          datasets: [{
            label: '活跃用户数',
            data: [42, 65, 87, 63, 52, 74, 98, 103, 86, 65, 48, 32],
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.4,
            yAxisID: 'y'
          }, {
            label: '文档访问量',
            data: [120, 190, 243, 170, 142, 205, 310, 352, 276, 182, 134, 86],
            borderColor: 'rgba(153, 102, 255, 1)',
            backgroundColor: 'rgba(153, 102, 255, 0.2)',
            tension: 0.4,
            yAxisID: 'y1'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
            },
            tooltip: {
              mode: 'index',
              intersect: false
            }
          },
          scales: {
            y: {
              type: 'linear',
              display: true,
              position: 'left',
              title: {
                display: true,
                text: '活跃用户数'
              }
            },
            y1: {
              type: 'linear',
              display: true,
              position: 'right',
              title: {
                display: true,
                text: '文档访问量'
              },
              grid: {
                drawOnChartArea: false
              }
            }
          }
        }
      });

      // 使用时段分布图表
      const timeCtx = document.getElementById('timeDistributionChart').getContext('2d');
      const timeChart = new Chart(timeCtx, {
        type: 'bar',
        data: {
          labels: ['8:00', '9:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00'],
          datasets: [{
            label: '使用人数',
            data: [32, 64, 95, 108, 75, 62, 98, 125, 137, 95, 72, 48, 35, 20],
            backgroundColor: 'rgba(75, 192, 192, 0.7)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1,
            borderRadius: 5
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: '使用人数'
              }
            }
          }
        }
      });

      // 部门使用对比图表
      const deptCtx = document.getElementById('departmentUsageChart').getContext('2d');
      const deptChart = new Chart(deptCtx, {
        type: 'radar',
        data: {
          labels: ['文档访问量', '搜索使用率', '上传贡献度', '互动参与度', '平均停留时间', '跨部门访问'],
          datasets: [{
            label: '研发部',
            data: [85, 72, 65, 45, 68, 52],
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            borderColor: 'rgba(75, 192, 192, 1)',
            pointBackgroundColor: 'rgba(75, 192, 192, 1)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(75, 192, 192, 1)'
          }, {
            label: '产品部',
            data: [78, 80, 70, 62, 75, 58],
            backgroundColor: 'rgba(153, 102, 255, 0.2)',
            borderColor: 'rgba(153, 102, 255, 1)',
            pointBackgroundColor: 'rgba(153, 102, 255, 1)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(153, 102, 255, 1)'
          }, {
            label: '市场部',
            data: [65, 68, 45, 75, 62, 70],
            backgroundColor: 'rgba(255, 159, 64, 0.2)',
            borderColor: 'rgba(255, 159, 64, 1)',
            pointBackgroundColor: 'rgba(255, 159, 64, 1)',
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(255, 159, 64, 1)'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              angleLines: {
                display: true
              },
              suggestedMin: 0,
              suggestedMax: 100
            }
          }
        }
      });

      // 用户行为分析图表
      const behaviorCtx = document.getElementById('userBehaviorChart').getContext('2d');
      const behaviorChart = new Chart(behaviorCtx, {
        type: 'line',
        data: {
          labels: ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
          datasets: [{
            label: '阅读文档',
            data: [68, 72, 70, 73, 75, 74, 76, 78, 77, 79, 75, 78],
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.1)',
            fill: true,
            tension: 0.4
          }, {
            label: '搜索内容',
            data: [58, 60, 62, 65, 63, 64, 66, 67, 65, 62, 63, 65],
            borderColor: 'rgba(54, 162, 235, 1)',
            backgroundColor: 'rgba(54, 162, 235, 0.1)',
            fill: true,
            tension: 0.4
          }, {
            label: '智能助手使用',
            data: [25, 28, 32, 35, 38, 42, 45, 48, 46, 44, 42, 45],
            borderColor: 'rgba(255, 99, 132, 1)',
            backgroundColor: 'rgba(255, 99, 132, 0.1)',
            fill: true,
            tension: 0.4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'top',
            },
            tooltip: {
              mode: 'index',
              intersect: false
            }
          },
          scales: {
            y: {
              min: 0,
              max: 100,
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              },
              title: {
                display: true,
                text: '使用比例'
              }
            }
          }
        }
      });
    });
  </script>

  <style>
    .avatar-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
    }
    
    .behavior-metric {
      margin-bottom: 20px;
    }
    
    .bg-primary-soft {
      background-color: rgba(13, 110, 253, 0.15);
      color: #0d6efd;
    }
    
    .bg-success-soft {
      background-color: rgba(25, 135, 84, 0.15);
      color: #198754;
    }
    
    .bg-info-soft {
      background-color: rgba(13, 202, 240, 0.15);
      color: #0dcaf0;
    }
    
    .bg-warning-soft {
      background-color: rgba(255, 193, 7, 0.15);
      color: #ffc107;
    }
    
    .bg-danger-soft {
      background-color: rgba(220, 53, 69, 0.15);
      color: #dc3545;
    }
  </style>
</body>
</html> 